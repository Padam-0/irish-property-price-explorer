{% extends 'homepage/header.html' %}

{% block content %}

    {% load staticfiles %}
    <link href="{% static 'tableview/css/index-style.css' %}" rel="stylesheet">
    <link href="{% static 'homepage/css/more-style.css' %}" rel="stylesheet">
    <link href="{% static 'homepage/css/seg-control.css' %}" rel="stylesheet">
    <script src="{% static 'tableview/js/index.js' %}"></script>
    <div id="table">
        <div id="aoi">
            <div id="aoi-title">
                <h3>Area of Interest</h3>
            </div>
            <div id="aoi-stats">
                <div id="aoi-stats-left">
                    <p id="aoi-p">Area of Interest:</p>
                </div>
                <div id="aoi-stats-right">
                    <p id="ned"></p>
                </div>
            </div>
            <div id="aoi-map">
                {% include 'reporter/includes/map-snippet.html' %}
                {% block map %}
                {% endblock %}
            </div>
        </div>
        <div id="options">
            <button class="accordion" id="filter-options"><span id="bleft">Change filter options:</span><span id="bright"><i class="fa fa-arrow-circle-right fa-2x" aria-hidden="true"></i></span></button>
            <div class="panel">
                <div id="search-area">
                    <input id="address" maxlength="100" name="address" placeholder="Search for an address..." type="text">
                    <button type="submit" class="btn btn-default" id="search-submit">Search</button>
                </div>
                <div id="map-cont">
                    <div id="map-area"></div>
                <div id="map-options">
                    <p>Show calculation area on map?</p>
                    <input type='checkbox' title="showonmap" id="showzone"></input>
                </div>
            </div>
            <div id="ag-opt-top">
            <div id="calc-opt">
                <p>Calculation Area: </p>
                <div class="segmented-control" id="sc">
                    <input type="radio" name="sc-5" id="sc-5-1-1" checked>
                    <input type="radio" name="sc-5" id="sc-5-1-2">
                    <input type="radio" name="sc-5" id="sc-5-1-3">
                    <input type="radio" name="sc-5" id="sc-5-1-4">
                    <input type="radio" name="sc-5" id="sc-5-1-5">

                    <label for="sc-5-1-1" data-value="Map">Map</label>
                    <label for="sc-5-1-2" data-value="Radius">Radius</label>
                    <label for="sc-5-1-3" data-value="County">County</label>
                    <label for="sc-5-1-4" data-value="Region">Region</label>
                    <label for="sc-5-1-5" data-value="Country">Country</label>
                </div>
            </div>
            <div id="dist-opt">
                <div id="dist-opt-left">
                    <div id="radius">
                        <p>Radius:</p>
                        <div>
                            <input title="radius-selector" id="radius-selector"></input>
                            <p>km</p>
                        </div>
                    </div>

                    <div id="region">
                        <p>Region: </p>
                        <div>
                            <datalist id="regions">
                                <option value="Connacht">Connacht</option>
                                <option value="Leinster">Leinster</option>
                                <option value="Munster">Munster</option>
                                <option value="Ulster">Ulster</option>
                            </datalist>
                            <input type="text" list="regions" title="region-selector" id="region-selector" placeholder="Start Typing">
                        </div>
                    </div>
                    <div id="county">
                        <p>County: </p>
                        <div>
                            <datalist id="counties">
                                <option value="Carlow">Carlow</option>
                                <option value="Cavan">Cavan</option>
                                <option value="Clare">Clare</option>
                                <option value="Cork">Cork</option>
                                <option value="Donegal">Donegal</option>
                                <option value="Dublin">Dublin</option>
                                <option value="Galway">Galway</option>
                                <option value="Kerry">Kerry</option>
                                <option value="Kildare">Kildare</option>
                                <option value="Kilkenny">Kilkenny</option>
                                <option value="Laois">Laois</option>
                                <option value="Leitrim">Leitrim</option>
                                <option value="Limerick">Limerick</option>
                                <option value="Longford">Longford</option>
                                <option value="Louth">Louth</option>
                                <option value="Mayo">Mayo</option>
                                <option value="Meath">Meath</option>
                                <option value="Monaghan">Monaghan</option>
                                <option value="Offaly">Offaly</option>
                                <option value="Roscommon">Roscommon</option>
                                <option value="Sligo">Sligo</option>
                                <option value="Tipperary">Tipperary</option>
                                <option value="Waterford">Waterford</option>
                                <option value="Westmeath">Westmeath</option>
                                <option value="Wexford">Wexford</option>
                                <option value="Wicklow">Wicklow</option>
                            </datalist>
                            <input type="text" list="counties" title="county-selector" id="county-selector" placeholder="Start Typing">
                        </div>
                    </div>
                </div>
                <div id="dist-opt-right">
                    <p>Remove Unmapped Data?</p>
                    <input type='checkbox' title="showonmap" id="bad_data"></input>
                </div>
            </div>

            <div id="sliders">
                <div id="tSlider"></div>
                <div class="slide">
                    <div class="slide-label">
                        <p>Start Date: </p>
                        <p id="t-value-lower"></p>
                    </div>
                    <div class="slide-label">
                        <p>End Date: </p>
                        <p id="t-value-upper"></p>
                    </div>
                </div>
                <div id="pSlider"></div>
                <div class="slide">
                    <div class="slide-label">
                        <p>Minimum Price: </p>
                        <p id="p-value-lower"></p>
                    </div>
                    <div class="slide-label">
                        <p>Maximum Price: </p>
                        <p id="p-value-upper"></p>
                    </div>
                </div>
            </div>
            <div id="recalc">
                <button class="btn btn-default" id="rec-button">Change Filter Options</button>
            </div>
        </div>
        </div>
        </div>
        <hr>

        <div id="tableview">
            <div id="filter">
                <div id="order">
                    <p id="lfilt">Order by:</p>
                    <div class="segmented-control" id="sc1">
                    <input type="radio" name="sc-1" id="sc-2-1-1" checked>
                    <input type="radio" name="sc-1" id="sc-2-1-2">

                    <label for="sc-2-1-1" data-value="Price">Price</label>
                    <label for="sc-2-1-2" data-value="Date of Sale">Date of Sale</label>
                </div>
                </div>
                <div id="direction">
                    <p>Direction:</p>
                    <div class="segmented-control" id="sc2">
                    <input type="radio" name="sc-2" id="sc-2-2-1" checked>
                    <input type="radio" name="sc-2" id="sc-2-2-2">

                    <label for="sc-2-2-1" data-value="Ascending">Ascending</label>
                    <label for="sc-2-2-2" data-value="Descending">Descending</label>
                </div>
                </div>
                <div id="len">
                    <p>Results:</p>
                    <div class="segmented-control" id="sc3">
                    <input type="radio" name="sc-3" id="sc-3-1-1" checked>
                    <input type="radio" name="sc-3" id="sc-3-1-2">
                    <input type="radio" name="sc-3" id="sc-3-1-3">

                    <label for="sc-3-1-1" data-value="10">10</label>
                    <label for="sc-3-1-2" data-value="25">25</label>
                    <label for="sc-3-1-3" data-value="50">50</label>
                </div>
                </div>
            </div>
            <div id="list"></div>

            <div id="pages"></div>

        </div>
    </div>

    <script type="text/javascript">
        var gmap;
        var classes = ['slider-color', 'default-color'];
        var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "June",
                "July", "Aug", "Sept", "Oct", "Nov", "Dec"];
        var globalZIndex = 1;

        function getArea(area){
            if (area == 'county') {
                county = document.getElementById("county-selector").value;
                data = getCountyEdges(county);

            } else if (area == 'region') {
                region = document.getElementById("region-selector").value;
                data = getRegionEdges(region);

            } else if (area == 'country') {
                data = "{% static 'homepage/ireland/country.geojson' %}";
            }

            return data;
        }

        function drawMapEdges(map) {

            var rectCoords = [
                {lat: map.getBounds().getSouthWest().lat(), lng: map.getBounds().getNorthEast().lng()},
                {lat: map.getBounds().getSouthWest().lat(), lng: map.getBounds().getSouthWest().lng()},
                {lat: map.getBounds().getNorthEast().lat(), lng: map.getBounds().getSouthWest().lng()},
                {lat: map.getBounds().getNorthEast().lat(), lng: map.getBounds().getNorthEast().lng()},
                {lat: map.getBounds().getSouthWest().lat(), lng: map.getBounds().getNorthEast().lng()}
            ];

            var viewRect = new google.maps.Polygon({
                paths: rectCoords,
                fillOpacity: 0.1,
                strokeColor: 'black',
                strokeOpacity: 0.7,
                strokeWeight: 3
            });

            overlays.push(viewRect);

            viewRect.setMap(map);
        }

        function getCountyEdges(county) {
            return "{% static 'homepage/ireland/counties/' %}" + county +
                ".geojson"
        }

        function getRegionEdges(region) {

            return "{% static 'homepage/ireland/regions/' %}" + region +
                ".geojson"
        }

        function drawRadius(map) {
            radius = document.getElementById("radius-selector").value;

            b = map.getBounds().getSouthWest().lat();
            t = map.getBounds().getNorthEast().lat();
            r = map.getBounds().getNorthEast().lng();
            l = map.getBounds().getSouthWest().lng();

            centroid = {lat: (t - b)/2 + b, lng: (l - r)/ 2 + r};

            var viewCirc = new google.maps.Circle({
                fillOpacity: 0.1,
                strokeColor: 'black',
                strokeOpacity: 0.7,
                strokeWeight: 3,
                map: map,
                center: centroid,
                radius: radius * 1000,
                zIndex: globalZIndex++
            });

            overlays.push(viewCirc);

            viewCirc.setMap(map);
        }

        function drawTimeSlider(){
            var tSlider = document.getElementById('tSlider');

            noUiSlider.create(tSlider, {
                start: [start_date, end_date],
                step: 86400000,
                connect: [false, true, false],
                margin: 604800000,
                behaviour: 'tap',
                range: {
                    'min': [start_date],
                    'max': [end_date]
                }
            });

            var connect = tSlider.querySelectorAll('.noUi-connect');
            var classes = ['slider-color', 'default-color'];

            for ( var i = 0; i < connect.length; i++ ) {
                connect[i].classList.add(classes[i]);
            }

            var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
                "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];

            var timeValues = [
                document.getElementById('t-value-lower'),
                document.getElementById('t-value-upper')
            ];

            tSlider.noUiSlider.on('update', function( values, handle ) {
                time = new Date(Math.round(values[handle]));

                timeValues[handle].innerHTML = time.getDate() + '-' +
                    monthNames[time.getUTCMonth()] + '-' +
                            String(time.getUTCFullYear()).slice(2);
            });
        }

        function drawPriceSlider(){
            minPrice = 0;
            maxPrice = max_p;

            var pSlider = document.getElementById('pSlider');

            noUiSlider.create(pSlider, {
                start: [minPrice, maxPrice],
                step: 10000,
                connect: [false, true, false],
                margin: 10000,
                behaviour: 'tap',
                range: {
                    'min': [minPrice],
                    'max': [maxPrice]
                }
            });

            var connect = pSlider.querySelectorAll('.noUi-connect');

            for (var i = 0; i < connect.length; i++ ) {
                connect[i].classList.add(classes[i]);
            }

            var priceValues = [
                document.getElementById('p-value-lower'),
                document.getElementById('p-value-upper')
            ];

            pSlider.noUiSlider.on('update', function( values, handle ) {
                val = values[handle];

                priceValues[handle].innerHTML = '€ ' + thousandsDisplay(val);
            });
        }

        function initMap() {
            if (document.cookie.indexOf('right') > 0){
                r = parseFloat(Cookies.get('right'));
                l = parseFloat(Cookies.get('left'));
                t = parseFloat(Cookies.get('top'));
                b = parseFloat(Cookies.get('bottom'));

                var center = {lng: (l - r)/2 + r, lat: (t - b)/2 + b};
            }

            gmap = new google.maps.Map(document.getElementById('map-area'), {
                center: center,
                zoom: 13,
                gestureHandling: 'cooperative',
                scrollwheel: false
            });
        }

        function update_list(len, ord, sor){

            data_to_send = {'length': len, 'order': ord, 'sort': sor};

            calcArea = Cookies.get('areaMain');
            data_to_send['calcArea'] = calcArea;

            data_to_send['dl'] = Cookies.get('min_date');
            data_to_send['dh'] = Cookies.get('max_date');
            data_to_send['pl'] = Cookies.get('min_price');
            data_to_send['ph'] = Cookies.get('max_price');

            data_to_send['r'] = Cookies.get('right');
            data_to_send['l'] = Cookies.get('left');
            data_to_send['t'] = Cookies.get('top');
            data_to_send['b'] = Cookies.get('bottom');

            data_to_send['bad_data'] = Cookies.get('bad_data_inc')

            if (calcArea == 'radius'){
                data_to_send['radius'] = Cookies.get('radius')
            } else if (calcArea == 'county'){
                data_to_send['areaSecond'] = Cookies.get('areaSecond')
            } else if (calcArea == 'region'){
                data_to_send['areaSecond'] = Cookies.get('areaSecond')
            }

            ajax_table(data_to_send, 1)
        }

        function ajax_table(data_to_send, offset){

            data_to_send['offset'] = offset;
            $.ajax({
                type: "GET",
                url: "/table/ajax-response-table/",
                data: data_to_send,
                async: true,
                dataType: 'json',
                success: function (data) {
                    for (var i = 0; i < data['points'].length; i++){

                        var circle = L.circle(data['points'][i], {
                            fillColor: '#05084E',
                            weight: 2,
                            opacity: 0.6,
                            color: '#05084E',
                            dashArray: null,
                            fillOpacity: 0.6,
                            radius: 15
                        }).addTo(map);
                    }

                    for (var key in data) {
                        if (key == 'results') { continue; }
                        if (key == 'points') { continue; }

                        d = data[key];

                        if (d['nfma'] == 'Yes') {
                            nfma = 'No'
                        } else {
                            nfma = 'Yes'
                        }

                        if (d['postcode'] == null) {
                            pc = ''
                        } else {
                            pc = d['postcode'] + '<br />'
                        }

                        if (d['dop'] == 'Second-Hand Dwelling house /Apartment') {
                            dop = 'Second-Hand';
                            vat = ''
                        } else {
                            dop = 'New';
                            vat = '<br />VAT Excluded: ' + d['vat_ex']
                        }

                        if (d['size'] != null) {
                            psd = '<br />Size Description: ' + d['size']
                        } else {
                            psd = ''
                        }

                        y = d['sale_date'].slice(0, 4);
                        m = d['sale_date'].slice(5, 7);
                        day = d['sale_date'].slice(8, 10);
                        if (day[0] == 0) {
                            day = day[1]
                        }
                        var monthNames = ["January", "February", "March", "April", "May", "June",
                            "July", "August", "September", "October", "November", "December"];
                        m = monthNames[m - 1];

                        sd = day + '-' + m + '-' + y;

                        ad = d['address'].toLowerCase()
                            .replace(function () {
                                if (d['postcode'] != null) {
                                    return ', ' + d['postcode'].toLowerCase()
                                } else {
                                    return ''
                                }
                            }, '')
                            .replace(function () {
                                if (d['postcode'] != null) {
                                    return ' ' + d['postcode'].toLowerCase()
                                } else {
                                    return ''
                                }
                            }, '')
                            .replace((d['county'] + ' City').toLowerCase(), '')
                            .replace(('Co. ' + d['county']).toLowerCase(), '')
                            .replace(('Co. ' + d['county']).toLowerCase(), '')
                            .replace(('Co ' + d['county']).toLowerCase(), '')
                            .replace(('Co.' + d['county']).toLowerCase(), '')
                            .replace(', ' + d['county'].toLowerCase(), '')
                            .replace(' ' + d['county'].toLowerCase(), '');

                        while (isNaN(parseInt(ad[ad.length - 1])) == false) {
                            ad = ad.slice(0, ad.length - 1)
                        }

                        if (ad[ad.length - 1].toLowerCase() == 'w' && ad[ad.length - 2] == 6) {
                            ad = ad.slice(0, ad.length - 2);
                            if (d['postcode'] == null) {
                                pc = 'Dublin 6W <br />'
                            }
                        }

                        while (ad[ad.length - 1] == ' ' || ad[ad.length - 1] == ',' || ad[ad.length - 1] == '.' ||
                            ad[ad.length - 1] == '1' || ad[ad.length - 1] == '2' || ad[ad.length - 1] == '3' ||
                            ad[ad.length - 1] == '4' || ad[ad.length - 1] == '5' || ad[ad.length - 1] == '6' ||
                            ad[ad.length - 1] == '7' || ad[ad.length - 1] == '8' || ad[ad.length - 1] == '9' ||
                            ad[ad.length - 1] == '0') {
                            ad = ad.slice(0, ad.length - 1)
                        }

                        $('#list').append(
                            '<div class="instance">' +
                            '<p><strong>' + toTitleCase(ad) + '<br />' +
                            '&euro;' + thousandsDisplay(parseFloat(d['price'])) + '</strong></p>' +
                            pc + 'Co. ' + d['county'] + '<br />' +
                            'Date of Sale: ' + sd + '<br />' +
                            'Sold at Full Market Price: ' + nfma + '<br />' +
                            'Property Condition: ' + dop + vat + psd + '<br /><br />' +
                            '</div>'
                        )
                    }

                    total = parseInt(data['results']);
                    $('#ned').text(thousandsDisplay(total));
                    pages = Math.floor(total / parseInt(data_to_send['length'])) + 1;

                    if (pages < 10){
                        if (pages == 1){

                        } else if (pages == 2){
                            if (offset == 1){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<p class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "</div>")
                            } else {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<p class='page-link'>2</p>" +
                                    "</div>")
                            }
                        } else if (pages == 3){
                            if (offset == 1){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<p class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "</div>")
                            } else if (offset == 2){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<p class='page-link'>2</p>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "</div>")
                            } else {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<p class='page-link'>3</p>" +
                                    "</div>")
                            }
                        } else if (pages == 4){
                            if (offset == 1){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<p class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "</div>")
                            } else if (offset == 2){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<p class='page-link'>2</p>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "</div>")
                            } else if (offset == 3){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<p class='page-link'>3</p>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "</div>")
                            } else {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<p class='page-link'>4</p>" +
                                    "</div>")
                            }
                        } else if (pages == 5){
                            if (offset == 1){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<p class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "</div>")
                            } else if (offset == 2){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<p class='page-link'>2</p>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "</div>")
                            } else if (offset == 3){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<p class='page-link'>3</p>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "</div>")
                            } else if (offset == 4) {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<p class='page-link'>4</p>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "</div>")
                            } else {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<p class='page-link'>5</p>" +
                                    "</div>")
                            }
                        } else if (pages == 6){
                            if (offset == 1){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<p class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "</div>")
                            } else if (offset == 2){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<p class='page-link'>2</p>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "</div>")
                            } else if (offset == 3){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<p class='page-link'>3</p>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "</div>")
                            } else if (offset == 4) {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<p class='page-link'>4</p>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "</div>")
                            } else if (offset == 5){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<p class='page-link'>5</p>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "</div>")
                            } else {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<p class='page-link'>6</p>" +
                                    "</div>")
                            }
                        } else if (pages == 7){
                            if (offset == 1){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<p class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "</div>")
                            } else if (offset == 2){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<p class='page-link'>2</p>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "</div>")
                            } else if (offset == 3){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<p class='page-link'>3</p>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "</div>")
                            } else if (offset == 4) {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<p class='page-link'>4</p>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "</div>")
                            } else if (offset == 5){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<p class='page-link'>5</p>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "</div>")
                            } else if (offset == 6) {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<p class='page-link'>6</p>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "</div>")
                            } else {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<p class='page-link'>7</p>" +
                                    "</div>")
                            }
                        } else if (pages == 8){
                            if (offset == 1){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<p class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "<a id='link8' class='page-link'>8</a>" +
                                    "</div>")
                            } else if (offset == 2){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<p class='page-link'>2</p>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "<a id='link8' class='page-link'>8</a>" +
                                    "</div>")
                            } else if (offset == 3){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<p class='page-link'>3</p>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "<a id='link8' class='page-link'>8</a>" +
                                    "</div>")
                            } else if (offset == 4) {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<p class='page-link'>4</p>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "<a id='link8' class='page-link'>8</a>" +
                                    "</div>")
                            } else if (offset == 5){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<p class='page-link'>5</p>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "<a id='link8' class='page-link'>8</a>" +
                                    "</div>")
                            } else if (offset == 6) {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<p class='page-link'>6</p>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "<a id='link8' class='page-link'>8</a>" +
                                    "</div>")
                            } else if (offset == 7) {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<p class='page-link'>7</p>" +
                                    "<a id='link8' class='page-link'>8</a>" +
                                    "</div>")
                            } else {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "<p class='page-link'>8</p>" +
                                    "</div>")
                            }
                        } else if (pages == 9){
                            if (offset == 1){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<p class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "<a id='link8' class='page-link'>8</a>" +
                                    "<a id='link9' class='page-link'>9</a>" +
                                    "</div>")
                            } else if (offset == 2){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<p class='page-link'>2</p>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "<a id='link8' class='page-link'>8</a>" +
                                    "<a id='link9' class='page-link'>9</a>" +
                                    "</div>")
                            } else if (offset == 3){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<p class='page-link'>3</p>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "<a id='link8' class='page-link'>8</a>" +
                                    "<a id='link9' class='page-link'>9</a>" +
                                    "</div>")
                            } else if (offset == 4) {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<p class='page-link'>4</p>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "<a id='link8' class='page-link'>8</a>" +
                                    "<a id='link9' class='page-link'>9</a>" +
                                    "</div>")
                            } else if (offset == 5){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<p class='page-link'>5</p>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "<a id='link8' class='page-link'>8</a>" +
                                    "<a id='link9' class='page-link'>9</a>" +
                                    "</div>")
                            } else if (offset == 6) {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<p class='page-link'>6</p>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "<a id='link8' class='page-link'>8</a>" +
                                    "<a id='link9' class='page-link'>9</a>" +
                                    "</div>")
                            } else if (offset == 7) {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<p class='page-link'>7</p>" +
                                    "<a id='link8' class='page-link'>8</a>" +
                                    "<a id='link9' class='page-link'>9</a>" +
                                    "</div>")
                            } else if (offset == 8){
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "<p class='page-link'>8</p>" +
                                    "<a id='link9' class='page-link'>9</a>" +
                                    "</div>")
                            } else {
                                $('#pages').append("<div id='pagelinks'>" +
                                    "<p class='page-link'>Page: <p>" +
                                    "<a id='link1' class='page-link'>1</p>" +
                                    "<a id='link2' class='page-link'>2</a>" +
                                    "<a id='link3' class='page-link'>3</a>" +
                                    "<a id='link4' class='page-link'>4</a>" +
                                    "<a id='link5' class='page-link'>5</a>" +
                                    "<a id='link6' class='page-link'>6</a>" +
                                    "<a id='link7' class='page-link'>7</a>" +
                                    "<p class='page-link'>9</p>" +
                                    "</div>")
                            }
                        }
                    } else {
                        if (offset == 1){
                            $('#pages').append("<div id='pagelinks'>" +
                                "<p class='page-link'>Page: <p>" +
                                "<p class='page-link'>1</p>" +
                                "<a id='link2' class='page-link'>2</a>" +
                                "<a id='link3' class='page-link'>3</a>" +
                                "<a id='link4' class='page-link'>4</a>" +
                                "<a id='link5' class='page-link'>5</a>" +
                                "<a id='link6' class='page-link'>6</a>" +
                                "<a id='link7' class='page-link'>7</a>" +
                                "<a id='link8' class='page-link'>8</a>" +
                                "<a id='link9' class='page-link'>9</a>" +
                                "<p class='page-link'>...</p>" +
                                "<a id='last' class='page-link'>" + (pages) + "</a>" +
                                "</div>")
                        } else if (offset == 2){
                            $('#pages').append("<div id='pagelinks'>" +
                                "<p class='page-link'>Page: <p>" +
                                "<a id='link1' class='page-link'>1</a>" +
                                "<p class='page-link'>2</p>" +
                                "<a id='link3' class='page-link'>3</a>" +
                                "<a id='link4' class='page-link'>4</a>" +
                                "<a id='link5' class='page-link'>5</a>" +
                                "<a id='link6' class='page-link'>6</a>" +
                                "<a id='link7' class='page-link'>7</a>" +
                                "<a id='link8' class='page-link'>8</a>" +
                                "<a id='link9' class='page-link'>9</a>" +
                                "<p class='page-link'>...</p>" +
                                "<a id='last' class='page-link'>" + (pages) + "</a>" +
                                "</div>")
                        } else if (offset == 3){
                            $('#pages').append("<div id='pagelinks'>" +
                                "<p class='page-link'>Page: <p>" +
                                "<a id='link1' class='page-link'>1</a>" +
                                "<a id='link2' class='page-link'>2</a>" +
                                "<p class='page-link'>3</p>" +
                                "<a id='link4' class='page-link'>4</a>" +
                                "<a id='link5' class='page-link'>5</a>" +
                                "<a id='link6' class='page-link'>6</a>" +
                                "<a id='link7' class='page-link'>7</a>" +
                                "<a id='link8' class='page-link'>8</a>" +
                                "<a id='link9' class='page-link'>9</a>" +
                                "<p class='page-link'>...</p>" +
                                "<a id='last' class='page-link'>" + (pages) + "</a>" +
                                "</div>")
                        } else if (offset == 4){
                            $('#pages').append("<div id='pagelinks'>" +
                                "<p class='page-link'>Page: <p>" +
                                "<a id='link1' class='page-link'>1</a>" +
                                "<a id='link2' class='page-link'>2</a>" +
                                "<a id='link3' class='page-link'>3</a>" +
                                "<p class='page-link'>4</p>" +
                                "<a id='link5' class='page-link'>5</a>" +
                                "<a id='link6' class='page-link'>6</a>" +
                                "<a id='link7' class='page-link'>7</a>" +
                                "<a id='link8' class='page-link'>8</a>" +
                                "<a id='link9' class='page-link'>9</a>" +
                                "<p class='page-link'>...</p>" +
                                "<a id='last' class='page-link'>" + (pages) + "</a>" +
                                "</div>")
                        } else if (offset == 5){
                            $('#pages').append("<div id='pagelinks'>" +
                                "<p class='page-link'>Page: <p>" +
                                "<a id='link1' class='page-link'>1</a>" +
                                "<a id='link2' class='page-link'>2</a>" +
                                "<a id='link3' class='page-link'>3</a>" +
                                "<a id='link4' class='page-link'>4</a>" +
                                "<p class='page-link'>5</p>" +
                                "<a id='link6' class='page-link'>6</a>" +
                                "<a id='link7' class='page-link'>7</a>" +
                                "<a id='link8' class='page-link'>8</a>" +
                                "<a id='link9' class='page-link'>9</a>" +
                                "<p class='page-link'>...</p>" +
                                "<a id='last' class='page-link'>" + (pages) + "</a>" +
                                "</div>")
                        } else if (offset == pages){
                            $('#pages').append("<div id='pagelinks'>" +
                                "<p class='page-link'>Page: <p>" +
                                "<a id='link1' class='page-link'>1</a>" +
                                "<p class='page-link'>...</p>" +
                                "<a id='link3' class='page-link'>" + (pages - 7) + "</a>" +
                                "<a id='link4' class='page-link'>" + (pages - 6) + "</a>" +
                                "<a id='link5' class='page-link'>" + (pages - 5) + "</a>" +
                                "<a id='link6' class='page-link'>" + (pages - 4) + "</a>" +
                                "<a id='link7' class='page-link'>" + (pages - 3) + "</a>" +
                                "<a id='link8' class='page-link'>" + (pages - 2) + "</a>" +
                                "<a id='link9' class='page-link'>" + (pages - 1) + "</a>" +
                                "<p class='page-link'>" + (pages) + "</a>" +
                                "</div>")
                        } else if (offset == pages - 1){
                            $('#pages').append("<div id='pagelinks'>" +
                                "<p class='page-link'>Page: <p>" +
                                "<a id='link1' class='page-link'>1</a>" +
                                "<p class='page-link'>...</p>" +
                                "<a id='link2' class='page-link'>" + (pages - 8) + "</a>" +
                                "<a id='link3' class='page-link'>" + (pages - 7) + "</a>" +
                                "<a id='link4' class='page-link'>" + (pages - 6) + "</a>" +
                                "<a id='link5' class='page-link'>" + (pages - 5) + "</a>" +
                                "<a id='link6' class='page-link'>" + (pages - 4) + "</a>" +
                                "<a id='link7' class='page-link'>" + (pages - 3) + "</a>" +
                                "<a id='link8' class='page-link'>" + (pages - 2) + "</a>" +
                                "<p class='page-link'>" + (pages - 1) + "</p>" +
                                "<a id='last' class='page-link'>" + (pages) + "</a>" +
                                "</div>")
                        } else if (offset == pages - 2){
                            $('#pages').append("<div id='pagelinks'>" +
                                "<p class='page-link'>Page: <p>" +
                                "<a id='link1' class='page-link'>1</a>" +
                                "<p class='page-link'>...</p>" +
                                "<a id='link2' class='page-link'>" + (pages - 8) + "</a>" +
                                "<a id='link3' class='page-link'>" + (pages - 7) + "</a>" +
                                "<a id='link4' class='page-link'>" + (pages - 6) + "</a>" +
                                "<a id='link5' class='page-link'>" + (pages - 5) + "</a>" +
                                "<a id='link6' class='page-link'>" + (pages - 4) + "</a>" +
                                "<a id='link7' class='page-link'>" + (pages - 3) + "</a>" +
                                "<p class='page-link'>" + (pages - 2) + "</p>" +
                                "<a id='link9' class='page-link'>" + (pages - 1) + "</a>" +
                                "<a id='last' class='page-link'>" + (pages) + "</a>" +
                                "</div>")
                        } else if (offset == pages - 3){
                            $('#pages').append("<div id='pagelinks'>" +
                                "<p class='page-link'>Page: <p>" +
                                "<a id='link1' class='page-link'>1</a>" +
                                "<p class='page-link'>...</p>" +
                                "<a id='link2' class='page-link'>" + (pages - 8) + "</a>" +
                                "<a id='link3' class='page-link'>" + (pages - 7) + "</a>" +
                                "<a id='link4' class='page-link'>" + (pages - 6) + "</a>" +
                                "<a id='link5' class='page-link'>" + (pages - 5) + "</a>" +
                                "<a id='link6' class='page-link'>" + (pages - 4) + "</a>" +
                                "<p class='page-link'>" + (pages - 3) + "</p>" +
                                "<a id='link8' class='page-link'>" + (pages - 2) + "</a>" +
                                "<a id='link9' class='page-link'>" + (pages - 1) + "</a>" +
                                "<a id='last' class='page-link'>" + (pages) + "</a>" +
                                "</div>")
                        } else if (offset == pages - 4){
                            $('#pages').append("<div id='pagelinks'>" +
                                "<p class='page-link'>Page: <p>" +
                                "<a id='link1' class='page-link'>1</a>" +
                                "<p class='page-link'>...</p>" +
                                "<a id='link2' class='page-link'>" + (pages - 8) + "</a>" +
                                "<a id='link3' class='page-link'>" + (pages - 7) + "</a>" +
                                "<a id='link4' class='page-link'>" + (pages - 6) + "</a>" +
                                "<a id='link5' class='page-link'>" + (pages - 5) + "</a>" +
                                "<p class='page-link'>" + (pages - 4) + "</p>" +
                                "<a id='link7' class='page-link'>" + (pages - 3) + "</a>" +
                                "<a id='link8' class='page-link'>" + (pages - 2) + "</a>" +
                                "<a id='link9' class='page-link'>" + (pages - 1) + "</a>" +
                                "<a id='last' class='page-link'>" + (pages) + "</a>" +
                                "</div>")
                        } else {
                            $('#pages').append("<div id='pagelinks'>" +
                                "<p class='page-link'>Page: <p>" +
                                "<a id='link1' class='page-link'>1</a>" +
                                "<p class='page-link'>...</p>" +
                                "<a id='link3' class='page-link'>" + (parseInt(offset) - 2) + "</a>" +
                                "<a id='link4' class='page-link'>" + (parseInt(offset) - 1) + "</a>" +
                                "<a id='link5' class='page-link'>" + (parseInt(offset)) + "</a>" +
                                "<p class='page-link'>" + (parseInt(offset) + 1) + "</p>" +
                                "<a id='link7' class='page-link'>" + (parseInt(offset) + 2) + "</a>" +
                                "<a id='link8' class='page-link'>" + (parseInt(offset) + 3) + "</a>" +
                                "<a id='link9' class='page-link'>" + (parseInt(offset) + 4) + "</a>" +
                                "<p class='page-link'>...</p>" +
                                "<a id='last' class='page-link'>" + (pages) + "</a>" +
                                "</div>")
                        }
                    }

                    $('#link1').click(function(){
                        $('#pages').html('');
                        $('#list').children().remove();
                        ajax_table(data_to_send, 1);
                    });

                    $('#link2').click(function(){
                        $('#pages').html('');
                        $('#list').children().remove();
                        ajax_table(data_to_send, $(this).html());
                    });

                    $('#link3').click(function(){
                        $('#pages').html('');
                        $('#list').children().remove();
                        ajax_table(data_to_send, $(this).html());
                    });

                    $('#link4').click(function(){
                        $('#pages').html('');
                        $('#list').children().remove();
                        ajax_table(data_to_send, $(this).html());
                    });

                    $('#link5').click(function(){
                        $('#pages').html('');
                        $('#list').children().remove();
                        ajax_table(data_to_send, $(this).html());
                    });

                    $('#link6').click(function(){
                        $('#pages').html('');
                        $('#list').children().remove();
                        ajax_table(data_to_send, $(this).html());
                    });

                    $('#link7').click(function(){
                        $('#pages').html('');
                        $('#list').children().remove();
                        ajax_table(data_to_send, $(this).html());
                    });

                    $('#link8').click(function(){
                        $('#pages').html('');
                        $('#list').children().remove();
                        ajax_table(data_to_send, $(this).html());
                    });

                    $('#link9').click(function(){
                        $('#pages').html('');
                        $('#list').children().remove();
                        ajax_table(data_to_send, $(this).html());
                    });

                    $('#last').click(function(){
                        $('#pages').html('');
                        $('#list').children().remove();
                        ajax_table(data_to_send, $(this).html());
                    });


                    $('#newFooter').remove();
                    $('#tableview').after(
                        "<div id='newFooter'>" +
                            "<a href='/'>" +
                                "<p>Property Price Explorer</p>" +
                            "</a>" +
                            "<div class='fsep'>|</div>" +
                            "<a href='/table'>" +
                                "<p>View Properties</p>" +
                            "</a>" +
                            "<div class='fsep'>|</div>" +
                            "<a href='/reporter'>" +
                                "<p>Demographic & Price History Reports</p>" +
                            "</a>" +
                            "<div class='fsep'>|</div>" +
                            "<a href='/hp-predictor'>" +
                                "<p>House Price Prediction</p>" +
                            "</a>" +
                            "<div class='fsep'>|</div>" +
                            "<a href='/risk'>" +
                                "<p>Mortgage Risk Dashboard</p>" +
                            "</a>" +
                            "<div class='fsep'>|</div>" +
                            "<a href='/our-data'>" +
                                "<p>Our Data</p>" +
                            "</a>" +
                            "<div class='fsep'>|</div>" +
                            "<a href='/privacy-cookies'>" +
                                "<p>Privacy & Data Collection</p>" +
                            "</a>" +
                            "<div class='fsep'>|</div>" +
                            "<a href='/contact'>" +
                                "<p>Contact</p>" +
                            "</a>" +
                        "</div>"
                    )


                },
                complete: function(data) {
                    if (data.responseJSON == null){
                        $('#list').append("<div id='nodata'><p>No results to display.</p>" +
                        "<p>Please try different filtering options.</p></div>");
                        $('#ned').text(0);
                    }
                }
            });
        }

        function toTitleCase(str){
            return str.replace(/\w\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();});
        }


        window.onload = function() {

        $('#filter-options').click(function(){

            display = $('.panel').css('maxHeight');
            if (display == '0px'){
                $('i').removeClass('fa-arrow-circle-right');
                $('i').addClass('fa-arrow-circle-down');
                $('.panel').css('maxHeight', '660px')
                           .css('minHeight', '660px')
                           .css('height', '710px');
                $('#options').css('flex', '0 0 710px');
            } else {

                $('i').removeClass('fa-arrow-circle-down');
                $('i').addClass('fa-arrow-circle-right');
                $('.panel')
                    .css('height', '0px')
                    .css('minHeight', '0px')
                    .css('maxHeight', '0px');
                $('#options').css('flex', '0 0 50px');
            }
        });

            if('{{ dom_ed }}' == 'Not Applicable'){
                $('#list').append("<div id='nodata'><p>No results to display.</p>" +
                    "<p>Please try different filtering options.</p></div>");
                $('#ned').text(0);
            }

            var lu = '{{ last_update }}';

            d = lu.slice(0, 2);
            m = lu.slice(3, 5);
            y = lu.slice(6, 10);

            start_date = new Date(2010, 0).getTime();

            end_date = new Date(y, m).getTime();

            max_p = {{ max_price }};

            drawTimeSlider();
            drawPriceSlider();
            drawMap();

            google.maps.event.addListener(gmap, 'dragend', function () {
                showZone();
            });

            google.maps.event.addListener(gmap, 'zoom_changed', function () {
                showZone();
            });

            ca = Cookies.get('areaMain');

            $('#aoi-stats-left')
                .append(function(){
                    if (ca == 'map'){
                        return '<p>Map Bounds (Latitide):</p>'
                    } else if (ca == 'radius'){
                        return '<p>Circle centered at:'
                    }
                })
                .append(function(){
                    if (ca == 'map'){
                        return '<p>Map Bounds (Longitude):</p>'
                    }
                })
                .append(function(){
                    if (ca == 'map' || ca == 'radius'){
                        return '<p>Primary Electoral District:</p><p>Number of Electoral Districts in Area:</p>'
                    }
                })
                .append('<p>Number of Properties Sold:</p>')
                .append('<p>Price Range:</p>')
                .append('<p>Date Range:</p>')
                .append(function(){
                    if (ca == 'county' || ca == 'region' || ca == 'country'){
                        return '<p>Unmappable Data Included?</p>';
                    }
                });

            pmax = Cookies.get('max_price');
            pmin = Cookies.get('min_price');
            dmax = new Date(Cookies.get('max_date') * 1);
            dmin = new Date(Cookies.get('min_date') * 1);

            $('#aoi-stats-right')
                .prepend(function(){
                    if (ca == 'map' || ca == 'radius'){
                         return '<p>{{ dom_ed }}</p><p>{{ n_ed }}</p>'
                    }
                })
                .prepend(function(){
                    if (ca == 'map'){
                        return '<p>' + to_dms(Cookies.get('right')) + ' W - ' + to_dms(Cookies.get('left')) + ' W</p>'
                    }
                })
                .prepend(function(){
                    if (ca == 'map'){
                        return '<p>' + to_dms(Cookies.get('bottom')) + ' N - ' + to_dms(Cookies.get('top')) + ' N</p>'
                    } else if (ca == 'radius'){
                        return '<p>' + to_dms(parseFloat((Cookies.get('top')) - parseFloat(Cookies.get('bottom')))/2 + parseFloat(Cookies.get('bottom'))) + ' N, ' +
                            to_dms(parseFloat((Cookies.get('right')) - parseFloat(Cookies.get('left')))/2 + parseFloat(Cookies.get('left'))) + ' W</p>'
                    }
                })
                .prepend(function(){
                    if (ca == 'map'){
                        return '<p>Rectangle bounded by coordinates below.</p>'
                    } else if (ca == 'radius'){
                        r = Cookies.get('radius');
                        return '<p>Circle of ' + r + 'km around centroid below.</p>'
                    } else if (ca == 'county'){
                        c = Cookies.get('areaSecond');
                        return '<p>Co. ' + c + '</p>'
                    } else if (ca == 'region'){
                        r = Cookies.get('areaSecond');
                        return '<p>' + r + '</p>'
                    } else {
                        return '<p>The Republic of Ireland</p>'
                    }
                });

            $('#ned')
                .after('<p>&euro;' + thousandsDisplay(pmin) + ' - ' + '&euro;' + thousandsDisplay(pmax) + '</p>')
                .after('<p>' + monthNames[dmin.getUTCMonth()] + ' ' + dmin.getUTCFullYear() + ' - ' +
                        monthNames[dmax.getUTCMonth()] + ' ' + dmax.getUTCFullYear() + '</p>')
                .after(function(){
                    if (ca == 'county' || ca == 'region' || ca == 'country'){
                        if (Cookies.get('bad_data_inc') == 'true'){
                            return '<p>Yes</p>'
                        } else {
                            return '<p>No</p>'
                        }
                    }
                });

            $('#sc-2-1-1')
                .click(function(){
                    if ($("#sc2 input[type='radio']:checked")[0].labels == null){
                        var selector = document.getElementsByName('sc-2');
                        for(var i = 0; i < selector.length; i++) {
                            //Check if button is checked
                            var button = selector[i];
                            if(button.checked) {
                                //Return value
                                id = button.id;
                            }
                        }

                        if (id.slice(id.length - 1) == 1){
                            sor = 'asc'
                        } else {
                            sor = 'desc'
                        }

                        selector = document.getElementsByName('sc-3');
                        for(var i = 0; i < selector.length; i++) {
                            //Check if button is checked
                            button = selector[i];
                            if(button.checked) {
                                //Return value
                                id = button.id;
                            }
                        }

                        if (id.slice(id.length - 1) == 1){
                            len = 10
                        } else if (id.slice(id.length - 1) == 2){
                            len = 25
                        } else {
                            len = 50
                        }


                    } else {
                        // Chrome
                        if ($("#sc3 input[type='radio']:checked")[0].labels[0].innerHTML == 10){
                            len = 10
                        } else if ($("#sc3 input[type='radio']:checked")[0].labels[0].innerHTML == 25){
                            len = 25
                        } else {
                            len = 50
                        }

                        if ($("#sc2 input[type='radio']:checked")[0].labels[0].innerHTML == 'Ascending'){
                            sor = 'asc'
                        } else {
                            sor = 'desc'
                        }
                    }

                    $('#list').children().remove();
                    $('#pages').html('');
                    update_list(len, sor, 'price');
                });

            $('#sc-2-1-2')
                .click(function(){
                    if ($("#sc2 input[type='radio']:checked")[0].labels == null){
                        var selector = document.getElementsByName('sc-2');
                        for(var i = 0; i < selector.length; i++) {
                            //Check if button is checked
                            var button = selector[i];
                            if(button.checked) {
                                //Return value
                                id = button.id;
                            }
                        }

                        if (id.slice(id.length - 1) == 1){
                            sor = 'asc'
                        } else {
                            sor = 'desc'
                        }

                        selector = document.getElementsByName('sc-3');
                        for(var i = 0; i < selector.length; i++) {
                            //Check if button is checked
                            button = selector[i];
                            if(button.checked) {
                                //Return value
                                id = button.id;
                            }
                        }

                        if (id.slice(id.length - 1) == 1){
                            len = 10
                        } else if (id.slice(id.length - 1) == 2){
                            len = 25
                        } else {
                            len = 50
                        }


                    } else {
                        // Chrome
                        if ($("#sc3 input[type='radio']:checked")[0].labels[0].innerHTML == 10){
                            len = 10
                        } else if ($("#sc3 input[type='radio']:checked")[0].labels[0].innerHTML == 25){
                            len = 25
                        } else {
                            len = 50
                        }

                        if ($("#sc2 input[type='radio']:checked")[0].labels[0].innerHTML == 'Ascending'){
                            sor = 'asc'
                        } else {
                            sor = 'desc'
                        }
                    }

                    $('#list').children().remove();
                    $('#pages').html('');
                    update_list(len, sor, 'sale_date');
                });

            $('#sc-2-2-1')
                .click(function(){
                    if ($("#sc1 input[type='radio']:checked")[0].labels == null){
                        var selector = document.getElementsByName('sc-1');
                        for(var i = 0; i < selector.length; i++) {
                            //Check if button is checked
                            var button = selector[i];
                            if(button.checked) {
                                //Return value
                                id = button.id;
                            }
                        }

                        if (id.slice(id.length - 1) == 1){
                            ord = 'price'
                        } else {
                            ord = 'sale_date'
                        }

                        selector = document.getElementsByName('sc-3');
                        for(var i = 0; i < selector.length; i++) {
                            //Check if button is checked
                            button = selector[i];
                            if(button.checked) {
                                //Return value
                                id = button.id;
                            }
                        }

                        if (id.slice(id.length - 1) == 1){
                            len = 10
                        } else if (id.slice(id.length - 1) == 2){
                            len = 25
                        } else {
                            len = 50
                        }
                    } else {
                        // Chrome
                        if ($("#sc1 input[type='radio']:checked")[0].labels[0].innerHTML == 'Price'){
                            ord = 'price'
                        } else {
                            ord = 'sale_date'
                        }

                        if ($("#sc2 input[type='radio']:checked")[0].labels[0].innerHTML == 10){
                            len = 10
                        } else if ($("#sc2 input[type='radio']:checked")[0].labels[0].innerHTML == 25){
                            len = 25
                        } else {
                            len = 50
                        }
                    }

                    $('#list').children().remove();
                    $('#pages').html('');
                    update_list(len, 'asc', ord);
                });

            $('#sc-2-2-2')
                .click(function(){
                    if ($("#sc1 input[type='radio']:checked")[0].labels == null){
                        var selector = document.getElementsByName('sc-1');
                        for(var i = 0; i < selector.length; i++) {
                            //Check if button is checked
                            var button = selector[i];
                            if(button.checked) {
                                //Return value
                                id = button.id;
                            }
                        }

                        if (id.slice(id.length - 1) == 1){
                            ord = 'price'
                        } else {
                            ord = 'sale_date'
                        }

                        selector = document.getElementsByName('sc-3');
                        for(var i = 0; i < selector.length; i++) {
                            //Check if button is checked
                            button = selector[i];
                            if(button.checked) {
                                //Return value
                                id = button.id;
                            }
                        }

                        if (id.slice(id.length - 1) == 1){
                            len = 10
                        } else if (id.slice(id.length - 1) == 2){
                            len = 25
                        } else {
                            len = 50
                        }
                    } else {
                        // Chrome
                        if ($("#sc1 input[type='radio']:checked")[0].labels[0].innerHTML == 'Price'){
                            ord = 'price'
                        } else {
                            ord = 'sale_date'
                        }

                        if ($("#sc2 input[type='radio']:checked")[0].labels[0].innerHTML == 10){
                            len = 10
                        } else if ($("#sc2 input[type='radio']:checked")[0].labels[0].innerHTML == 25){
                            len = 25
                        } else {
                            len = 50
                        }
                    }

                    $('#list').children().remove();
                    $('#pages').html('');
                    update_list(len, 'desc', ord);
                });

            $('#sc-3-1-1')
                .click(function(){
                    if ($("#sc1 input[type='radio']:checked")[0].labels == null){
                        var selector = document.getElementsByName('sc-1');
                        for(var i = 0; i < selector.length; i++) {
                            //Check if button is checked
                            var button = selector[i];
                            if(button.checked) {
                                //Return value
                                id = button.id;
                            }
                        }

                        if (id.slice(id.length - 1) == 1){
                            ord = 'price'
                        } else {
                            ord = 'sale_date'
                        }

                        selector = document.getElementsByName('sc-2');
                        for(var i = 0; i < selector.length; i++) {
                            //Check if button is checked
                            button = selector[i];
                            if(button.checked) {
                                //Return value
                                id = button.id;
                            }
                        }

                        if (id.slice(id.length - 1) == 1){
                            sor = 'asc'
                        } else {
                            sor = 'desc'
                        }

                    } else {
                        // Chrome
                        if ($("#sc1 input[type='radio']:checked")[0].labels[0].innerHTML == 'Price'){
                            ord = 'price'
                        } else {
                            ord = 'sale_date'
                        }
                        if ($("#sc2 input[type='radio']:checked")[0].labels[0].innerHTML == 'Ascending'){
                            sor = 'asc'
                        } else {
                            sor = 'desc'
                        }
                    }

                    $('#list').children().remove();
                    $('#pages').html('');
                    update_list(10, sor, ord);
                });

            $('#sc-3-1-2')
                .click(function(){
                    if ($("#sc1 input[type='radio']:checked")[0].labels == null){
                        var selector = document.getElementsByName('sc-1');
                        for(var i = 0; i < selector.length; i++) {
                            //Check if button is checked
                            var button = selector[i];
                            if(button.checked) {
                                //Return value
                                id = button.id;
                            }
                        }

                        if (id.slice(id.length - 1) == 1){
                            ord = 'price'
                        } else {
                            ord = 'sale_date'
                        }

                        selector = document.getElementsByName('sc-2');
                        for(var i = 0; i < selector.length; i++) {
                            //Check if button is checked
                            button = selector[i];
                            if(button.checked) {
                                //Return value
                                id = button.id;
                            }
                        }

                        if (id.slice(id.length - 1) == 1){
                            sor = 'asc'
                        } else {
                            sor = 'desc'
                        }
                    } else {
                        // Chrome
                        if ($("#sc1 input[type='radio']:checked")[0].labels[0].innerHTML == 'Price'){
                            ord = 'price'
                        } else {
                            ord = 'sale_date'
                        }
                        if ($("#sc2 input[type='radio']:checked")[0].labels[0].innerHTML == 'Ascending'){
                            sor = 'asc'
                        } else {
                            sor = 'desc'
                        }
                    }

                    $('#list').children().remove();
                    $('#pages').html('');
                    update_list(25, sor, ord);
                });

            $('#sc-3-1-3')
                .click(function(){
                    if ($("#sc1 input[type='radio']:checked")[0].labels == null){
                        var selector = document.getElementsByName('sc-1');
                        for(var i = 0; i < selector.length; i++) {
                            //Check if button is checked
                            var button = selector[i];
                            if(button.checked) {
                                //Return value
                                id = button.id;
                            }
                        }

                        if (id.slice(id.length - 1) == 1){
                            ord = 'price'
                        } else {
                            ord = 'sale_date'
                        }

                        selector = document.getElementsByName('sc-2');
                        for(var i = 0; i < selector.length; i++) {
                            //Check if button is checked
                            button = selector[i];
                            if(button.checked) {
                                //Return value
                                id = button.id;
                            }
                        }

                        if (id.slice(id.length - 1) == 1){
                            sor = 'asc'
                        } else {
                            sor = 'desc'
                        }
                    } else {
                        // Chrome
                        if ($("#sc1 input[type='radio']:checked")[0].labels[0].innerHTML == 'Price'){
                            ord = 'price'
                        } else {
                            ord = 'sale_date'
                        }
                        if ($("#sc2 input[type='radio']:checked")[0].labels[0].innerHTML == 'Ascending'){
                            sor = 'asc'
                        } else {
                            sor = 'desc'
                        }
                    }

                    $('#list').children().remove();
                    $('#pages').html('');
                    update_list(50, sor, ord);
                });

            update_list(10, 'asc', 'price');
        }

    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCXosjHZchd8S-A7xEes69FhCX18rqJHUw&callback=initMap"></script>

{% endblock %}